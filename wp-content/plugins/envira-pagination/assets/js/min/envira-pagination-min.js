function envira_pagination_get_query_arg(e,a){e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),t=i.exec(a);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}var envira_pagination_requesting=!1;jQuery(document).ready(function($){$(document).on("click","div.envira-pagination-ajax-load a",function(e){if(e.preventDefault(),!envira_pagination_requesting){envira_pagination_requesting=!0;var a=$(this).parent(),i=$(a).parent().attr("id").split("envira-gallery-wrap-")[1],t=$(a).parent().find("div#envira-gallery-"+i),n=$(a).data("type"),r=envira_pagination_get_query_arg("page",$(this).attr("href"));$.ajax({type:"POST",url:envira_pagination.ajax,data:{action:"envira_pagination_get_page",nonce:envira_pagination.nonce,post_id:i,type:n,page:r,gallery_sort:envira_gallery_sort}}).done(function(e){if(""!=e){var o=$(e),s=$(o).find("div#envira-gallery-"+i),p=$(o).find(".envira-pagination-ajax-load").first();$(".envira-pagination-ajax-load",$(a).parent()).replaceWith($(p)),$(t).replaceWith($(s));var l=$("#envira-gallery-"+i);if(l.hasClass("envira-gallery-justified-public")){l.enviraJustifiedGallery({rowHeight:l.data("row-height"),maxRowHeight:-1,selector:"> div > div",lastRow:"nojustify"}),l.css("opacity","1");var g=l.data("gallery-theme");("js-desaturate"==g||"js-threshold"==g||"js-blur"==g||"js-vintage"==g)&&l.on("jg.complete",function(e){navigator.userAgent.match(/msie/i)||$.browser.msie||navigator.appVersion.indexOf("Trident/")>0?($('#envira-gallery-<?php echo $data["id"]; ?> img').each(function(){var e=$(this).attr("id");switch($(this).attr("id",e+"-effects"),$(this).wrap('<div class="effect-wrapper" style="display:inline-block;width:'+this.width+"px;height:"+this.height+'px;">').clone().addClass("gotcolors").css({position:"absolute",opacity:0,"z-index":1}).attr("id",e).insertBefore(this),g){case"js-desaturate":this.src=jg_effect_desaturate($(this).attr("src"));break;case"js-threshold":this.src=jg_effect_threshold(this.src);break;case"js-blur":this.src=jg_effect_blur(this.src);break;case"js-vintage":jg_effect_vintage(this)}}),$("#envira-gallery-"+i+" img").hover(function(){$(this).stop().animate({opacity:1},200)},function(){$(this).stop().animate({opacity:0},200)})):$("#envira-gallery-"+i+" img").hover(function(){$(this).removeClass("envira-"+g)},function(){$(this).addClass("envira-"+g)})})}!l.hasClass("envira-justified-gallery")&&l.hasClass("enviratope")&&(envira_isotopes[i]=l.enviratope(envira_isotopes_config[i]).enviratope("layout"),envira_isotopes[i].enviraImagesLoaded().done(function(e){envira_isotopes[i].enviratope("layout")}).progress(function(e,a){envira_isotopes[i].enviratope("layout")})),$("#envira-gallery-"+i+" .envira-gallery-item img").fadeTo("slow",1),$.envirabox.update(),$(document).trigger({type:"envira_pagination_ajax_load_completed",id:i,id_type:n,page:r,response:e}),envira_pagination_requesting=!1}}).fail(function(e){$(document).trigger({type:"envira_pagination_ajax_load_error",id:i,id_type:n,page:r,response:e})})}}),$("div.envira-pagination-lazy-load").each(function(){var e=$(this).parent(),a=$(this).data("type"),i=$(this).parent().attr("id").split("envira-gallery-wrap-")[1],t=Number($(this).attr("data-page")),n=!1;$(this).hide(),$(window).bind("scroll",function(){if($(window).scrollTop()>=$(e).offset().top+$(e).outerHeight()-window.innerHeight){if(n)return;n=!0,$.ajax({type:"POST",url:envira_pagination.ajax,data:{action:"envira_pagination_get_items",nonce:envira_pagination.nonce,post_id:i,type:a,page:Number(t+1)}}).done(function(r){if(""!=r){var o=$("#envira-gallery-"+i);o.hasClass("envira-gallery-justified-public")?(o.append(r),o.enviraJustifiedGallery("norewind")):o.hasClass("enviratope")?(o.enviratope("insert",$(r)),envira_isotopes[i]=o.enviratope(envira_isotopes_config[i]).enviratope("layout"),envira_isotopes[i].enviraImagesLoaded().done(function(e){envira_isotopes[i].enviratope("layout")}).progress(function(e,a){envira_isotopes[i].enviratope("layout")})):o.append(r),$("#envira-gallery-"+i+" .envira-gallery-item img").fadeTo("slow",1),$.envirabox.update(),t=Number(t+1),$("div.envira-pagination-ajax-load",$(e)).attr("data-page",t),$(document).trigger({type:"envira_pagination_lazy_load_completed",id:i,id_type:a,page:t,response:r}),n=!1}}).fail(function(e){$(document).trigger({type:"envira_pagination_lazy_load_error",id:i,id_type:a,page:t,response:e})})}})})});