!function($){$(function(){function e(){$(".envira-fc-chosen").chosen(),n();var e=$("#envira-config-fc-post-type").val();e?($("#envira-config-fc-inc-ex option:selected").trigger("change").trigger("chosen:updated"),chosen_post?i(e):(chosen_post=!0,r(e)),a?t(e):(a=!0,o(e))):($('#envira-config-fc-post-type option[value="post"]').attr("selected","selected").trigger("change").trigger("chosen:updated"),chosen_post||(chosen_post=!0,r(e)),a||(a=!0,o(e))),$("#envira-config-fc-post-type").chosen().change(function(){var e=$("#envira-config-fc-post-type").val();e&&(i(e),t(e))})}function n(){$("#envira-config-fc-post-title").is(":checked")?$("#envira-config-fc-post-title-link-box").show():$("#envira-config-fc-post-title-link-box").hide(),$(document).on("change","#envira-config-fc-post-title",function(){$(this).is(":checked")?$("#envira-config-fc-post-title-link-box").fadeIn():$("#envira-config-fc-post-title-link-box").fadeOut()}),"post_content"==$("#envira-config-fc-content-type").val()?$("#envira-config-fc-content-length-box, #envira-config-fc-content-ellipses-box, #envira-content-fc-content-html").show():$("#envira-config-fc-content-length-box, #envira-config-fc-content-ellipses-box, #envira-content-fc-content-html").hide(),$(document).on("change","#envira-config-fc-content-type",function(){"post_content"==$(this).val()?$("#envira-config-fc-content-length-box, #envira-config-fc-content-ellipses-box, #envira-content-fc-content-html").fadeIn():$("#envira-config-fc-content-length-box, #envira-config-fc-content-ellipses-box, #envira-content-fc-content-html").fadeOut()}),$("#envira-config-fc-read-more").is(":checked")?$("#envira-config-fc-read-more-text-box").show():$("#envira-config-fc-read-more-text-box").hide(),$(document).on("change","#envira-config-fc-read-more",function(){$(this).is(":checked")?$("#envira-config-fc-read-more-text-box").fadeIn():$("#envira-config-fc-read-more-text-box").fadeOut()})}function t(e){if(!a)return void(a=!0);e||(e=["post"]),$("#envira_config_fc_terms_chosen").after('<span class="spinner envira-spinner" style="display:inline-block;"></span>');var n={type:"post",url:envira_gallery_metabox.ajax,async:!0,cache:!1,dataType:"json",data:{action:"envira_featured_content_refresh_terms",nonce:envira_fc_metabox.term_nonce,post_type:e,post_id:envira_gallery_metabox.id},success:function(e){e&&e.error?($(".envira-spinner").remove(),$("#envira-config-fc-terms option:selected").removeAttr("selected").trigger("change").trigger("chosen:updated"),$("#envira-config-fc-terms-box").fadeOut(),$("#envira-config-fc-terms-relation-box").fadeOut()):$("#envira-config-fc-terms-box").fadeIn("normal",function(){$("#envira-config-fc-terms-relation-box").fadeIn(),$(".envira-spinner").remove(),$("#envira-config-fc-terms").empty().append(e).trigger("change").trigger("chosen:updated")})},error:function(e){$(".envira-spinner").remove()}};$.ajax(n)}function o(e){var n={type:"post",url:envira_gallery_metabox.ajax,async:!0,cache:!1,dataType:"json",data:{action:"envira_featured_content_refresh_terms",nonce:envira_fc_metabox.term_nonce,post_type:e,post_id:envira_gallery_metabox.id},success:function(e){return e&&e.error?($("#envira-config-fc-terms-box").hide(),void $("#envira-config-fc-terms-relation-box").hide()):($("#envira-config-fc-terms-box").show(),$("#envira-config-fc-terms-relation-box").show(),$("#envira-config-fc-terms").empty().append(e),$("#envira_fc_terms_chzn .chzn-results li.result-selected").each(function(){var e=$(this);$("#envira-config-fc-terms option").each(function(){$(this).text()==e.text()&&$(this).attr("selected","selected")})}),$("#envira-config-fc-terms").trigger("change").trigger("chosen:updated"),void 0)},error:function(e){}};$.ajax(n)}function c(e){var n={type:"post",url:envira_gallery_metabox.ajax,async:!0,cache:!1,dataType:"json",data:{action:"envira_featured_content_refresh_terms",nonce:envira_fc_metabox.term_nonce,post_type:e,post_id:envira_gallery_metabox.id},success:function(e){e&&e.error?($(".envira-spinner").remove(),$("#envira-config-fc-terms option:selected").removeAttr("selected").trigger("change").trigger("chosen:updated"),$("#envira-config-fc-terms-box").fadeOut(),$("#envira-config-fc-terms-relation-box").fadeOut()):$("#envira-config-fc-terms-box").fadeIn("normal",function(){$("#envira-config-fc-terms-relation-box").fadeIn(),$(".envira-spinner").remove(),$("#envira-config-fc-terms").empty().append(e).trigger("change").trigger("chosen:updated")})},error:function(e){}};$.ajax(n)}function i(e){if(!chosen_post)return void(chosen_post=!0);e||(e=["post"]),$("#envira_config_fc_post_type_chosen").after('<span class="spinner envira-spinner" style="display:inline-block;"></span>');var n={type:"post",url:envira_gallery_metabox.ajax,async:!0,cache:!1,dataType:"json",data:{action:"envira_featured_content_refresh_posts",nonce:envira_fc_metabox.refresh_nonce,post_type:e,post_id:envira_gallery_metabox.id},success:function(e){e&&e.error?($(".envira-spinner").remove(),$("#envira-config-fc-inc-ex option:selected").removeAttr("selected").trigger("change").trigger("chosen:updated"),$("#envira-config-fc-inc-ex-box").fadeOut()):$("#envira-config-fc-inc-ex-box").fadeIn("normal",function(){$(".envira-spinner").remove(),$("#envira-config-fc-inc-ex").empty().append(e).trigger("change").trigger("chosen:updated")})},error:function(e){$(".envira-spinner").remove()}};$.ajax(n)}function r(e){var n={action:"envira_featured_content_refresh_posts",nonce:envira_fc_metabox.refresh_nonce,post_type:e,post_id:envira_gallery_metabox.id};$.post(envira_gallery_metabox.ajax,n,function(e){return e&&e.error?void $("#envira-config-fc-inc-ex-box").hide():($("#envira-config-fc-inc-ex-box").show(),$("#envira-config-fc-inc-ex").empty().append(e),$("#envira_fc_include_exclude_chzn .chzn-results li.result-selected").each(function(){var e=$(this);$("#envira-config-fc-inc-ex option").each(function(){$(this).text()==e.text()&&$(this).attr("selected","selected")})}),$("#envira-config-fc-inc-ex").trigger("change").trigger("chosen:updated"),void 0)},"json")}$(document).on("change","#envira-fc select, #envira-fc input",function(e){$(document).trigger("enviraGalleryPreview")});var a=chosen_post=!1;e(),$(document).on("enviraGalleryType",function(n,t){t.type&&"fc"==t.type&&e()})})}(jQuery);